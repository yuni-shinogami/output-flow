# スライド分析ガイド

パスB（既存スライドから作成）の詳細手順。

## 目次

- 素材の準備
- カラー分析
- レイアウトパターン分析
- タイポグラフィ・容量分析
- 分析結果の統合

## 素材の準備

### Marpスライド (.md)

そのまま読み取り可能。`_class:` の使用状況とHTML構造を確認。

### PDF → 画像変換

```bash
# pdftoppm（poppler-utils）
pdftoppm -png -r 150 input.pdf output-prefix

# ImageMagick
convert -density 150 input.pdf output-%03d.png
```

### 分析に必要な枚数の目安

| 枚数 | 精度 | 推奨場面 |
|:-----|:-----|:---------|
| 10-20枚 | 基本パターンの把握 | 単一プレゼンの分析 |
| 50-100枚 | 安定したパターン抽出 | 複数プレゼンの分析（推奨） |
| 100枚以上 | 高精度な容量制限の測定 | デザインシステムの厳密な構築 |

## カラー分析

### 手順

1. スライド画像を **5枚ずつバッチ** で Vision に渡す
2. 各スライドから以下を抽出:
   - 背景色（単色 or グラデーション）
   - 見出しの色
   - 本文テキストの色
   - アクセント色（箇条書きマーカー、枠線、ハイライト等）
   - 区切り線や装飾の色
3. 抽出した色を集計し、頻出パターンを特定

### 出力形式

```
カラーパレット:
- メインカラー: #XXXXXX（用途: 見出し、アクセント）
- ダーク: #XXXXXX（用途: グラデーション始点）
- ライト: #XXXXXX（用途: グラデーション終点）
- テキスト色: #XXXXXX
- 背景色: #XXXXXX
- グレー: #XXXXXX（用途: 区切り線、サブテキスト）
- グラデーション: linear-gradient(角度, #始点, #終点)
```

## レイアウトパターン分析

### 手順

1. 全スライドを以下のカテゴリに分類:
   - **表紙系**: タイトルスライド、カバー
   - **区切り系**: セクション区切り、ブリッジ
   - **コンテンツ系**: 箇条書き、ツリー構造、コード表示
   - **強調系**: 大文字強調、強調+補足
   - **まとめ系**: 番号リスト、結論
   - **特殊系**: 自己紹介、比較、Q&A

2. 各カテゴリのスライドを詳細分析:
   - レイアウト構造（中央配置、左右分割、上下分割）
   - テキストの配置と揃え
   - 背景パターン（単色、グラデーション、画像）
   - 装飾要素（枠線、バー、アイコン）

3. パターンに `_class` 名をつけて整理

### 出力形式（パターンごとに）

```
パターン名: cover
_class名: cover
用途: プレゼンテーションの表紙
出現頻度: 全スライドの約5%
特徴:
  - グラデーション背景
  - 中央配置の大文字タイトル
  - サブタイトル下部配置
CSS構造: display:flex, justify-content:center, align-items:center
```

## タイポグラフィ・容量分析

### 手順

1. 各パターンごとに以下を測定:
   - h1 のフォントサイズ（相対値 em 推奨）
   - h2 のフォントサイズ
   - 本文のフォントサイズ
   - 行間（line-height）
   - 箇条書きの最大項目数
   - 1行あたりの最大文字数（見出し・本文別）

2. フォントファミリーを特定:
   - 日本語フォント
   - 英語フォント
   - コードフォント

3. NGパターンを収集:
   - テキスト溢れが起きているスライド
   - 文字が小さすぎるスライド
   - 密度が高すぎるスライド

### 容量制限の算出

パターンごとに以下の形式で算出:

```
パターン: content
  h2: 最大20文字（1行）
  箇条書き: 最大5項目
  1項目: 最大30文字（1行）
  コードブロック: 最大8行
```

**算出基準**: スライドの padding, font-size, `overflow: hidden` の制約から、テキストがはみ出さない最大量を計算。実測値がある場合はそちらを優先。

## 分析結果の統合

すべての分析が終わったら、以下の形式でユーザーに提示する:

```markdown
## 分析サマリ

### カラーパレット
[カラー分析結果]

### レイアウトパターン（N種類）
| パターン名 | _class名 | 用途 |
|:-----------|:---------|:-----|
| ... | ... | ... |

### タイポグラフィ
- フォント: ...
- 見出しサイズ: ...
- 本文サイズ: ...

### 容量ルール
[パターン別の容量制限テーブル]

### 推奨事項
[分析から得られた改善点や注意点]
```

**ユーザーの確認後、SKILL.md のステップ3（docs生成）に進む。**
